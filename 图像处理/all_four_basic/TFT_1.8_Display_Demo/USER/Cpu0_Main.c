#include "headfile.h"
#pragma section all "cpu0_dsram"
//??????????
//--???
extern uint8 image[MT9V03X_H][MT9V03X_W];
//--???
//--???
extern int16 speedl;
extern int16 speedr;
int core0_main(void)
{
    //???????????
    get_clk();
    //?????????  ??????
    lcd_init(); //?????IPS???
    lcd_showstr(0, 0, "SEEKFREE MT9V03x");
    lcd_showstr(0, 1, "Initializing...");
    ecounter_init();    //???????????
    mt9v03x_init();     //??????????
    smotor_init();      //????????
    PWM_init();         //?????PWM
    pid_init();         //p i d?????
    pit_init(CCU6_0, PIT_CH0, 1000);    //?????????§Ø?
    GetCDFTable();      //???CDF??
    pit_enable_interrupt(CCU6_0, PIT_CH0);
    IfxCpu_emitEvent(&g_cpuSyncEvent);
    IfxCpu_waitEvent(&g_cpuSyncEvent, 0xFFFF);
    enableInterrupts();
    //???????????
    while (TRUE)
    {
        if(mt9v03x_finish_flag)
        {
            //?????
            Image_process();
            //??????
            //get_ecounter();
            //speed_control();
            //??????
            //binImage_display(160,MT9V03X_H);  //???????????
            draw_line();    //??????????????????
            lcd_displayimage032(mt9v03x_image[0], MT9V03X_W, MT9V03X_H);
            mt9v03x_finish_flag = 0;//????????????  ?????????¦Ë???????????????????
        }

    }
}

#pragma section all restore


